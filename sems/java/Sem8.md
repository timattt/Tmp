# Семинар 8

## Заголовки объектов

Написано на базе [статьи](https://habr.com/ru/articles/447848/)

* В 32-битной системе заголовок весит 8 байт = 4 байта markword (параметры) + 4 байта classword (указатель на класс)
* Markword может иметь одно из 5 состояний:
  * Обычное. В таком состоянии в параметре хранятся следуcющие вещи:
    * identity hash code - который генерирует System.hashCode - это рандомный hash код. Генерируется один раз для каждого объекта, а потом хранится в заголовке. Важно, что в разных JVM это не всегда так, например в Hotspot хешкод генерируется иначе.
    * age - возраст объекта в gc
    * биты идентифицирующие состояние
  * biased-lock - объект был свободен, потом им завладел один поток и пока больше никто на объект не претендует.
    * thread - идентификатор потока-владельца
    * epoch - параметр, который описывает эпоху блокирования
    * age - возраст объекта в gc
    * биты идентифицирующие состояние
  * lightweight-lock - блокировка с помощью атомика и спин лока.
    * ptr-to-lock-record - указатель на атомик
    * биты идентифицирующие состояние - уменьшены
  * heavyweight lock - полноценный замок с помощью mutex
    * ptr-to-heavyweight-konitor - указатель на mutex
    * биты идентифицирующие состояние - уменьшены
   
